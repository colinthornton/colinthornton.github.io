{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/google-sheets-autosort/","result":{"data":{"site":{"siteMetadata":{"title":"colinthornton"}},"markdownRemark":{"id":"bc752c34-c041-53cf-90b4-2899df2e9caa","excerpt":"I’m currently on the job hunt so I’ve been tracking the dates of my applications/interviews/offers/rejections with a spreadsheet. I wanted to keep everything…","html":"<p>I’m currently on the job hunt so I’ve been tracking the dates of my applications/interviews/offers/rejections with a spreadsheet.</p>\n<p>I wanted to keep everything sorted by those columns so that the applications that are most furthest along in the process (and not rejected) are sorted to the top rows. If you click on the column letter you can select <code class=\"language-text\">Sort sheet A→Z</code>, but then you have to do that for each column separately. It’s slow and clumsy. Let’s see if we can’t automate that process.</p>\n<h2>Enter script editor</h2>\n<p>Luckily Google provides us with a pretty <a href=\"https://developers.google.com/apps-script/reference/spreadsheet\">rich API</a> and <a href=\"https://developers.google.com/apps-script/guides/triggers/events#google_sheets_events\">event triggers</a> that we can interact with via JavaScript. From the menu, select <code class=\"language-text\">Tools</code> > <code class=\"language-text\">Script editor</code> to open a new page with a blank editor.</p>\n<p>Here’s the script I came up with for my problem, which sorts my sheet in the manner and order specified in <code class=\"language-text\">SORT_ORDER</code> after editing any cell:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">SHEET_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Sheet1\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SORT_DATA_RANGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"A2:L\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SORT_ORDER</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Application</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Response</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Screening</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Interview</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Offer</span>\n  <span class=\"token punctuation\">{</span> column<span class=\"token operator\">:</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Rejected</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">onEdit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">multiSortColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">multiSortColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ss <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> ss<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SHEET_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> range <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SORT_DATA_RANGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token constant\">SORT_ORDER</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">sortOrder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    range<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span>sortOrder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  ss<span class=\"token punctuation\">.</span><span class=\"token function\">toast</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sort complete.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here’s what the results look like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f01d077285902b834c132af8db83b1a7/ef916/google-sheets-autosort-example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABJ0AAASdAHeZh94AAAA/UlEQVQY012Q607DMAyF+/7PNlAHjHWo64Ufa7umS5M2Sa85OAaERKRInyz7nGNHehjRKw3RdXBuwjgatIJ4+mbRPTBQj5tmyF5x7zwvXAu8rBv0MKD76YseUqIoP5FeM1g3s/Dh8IzmLqCUIn7COfnAaCyS5ILXtxOxQ9u2OL2fydSy2PH4gnsrEN1uFXpyDm/fPSbnkKYprlmGbdvR1DUZlrDWQsoeJXHYyhiDLMtRVTXPSgq2e4+oaRp281T0/k8wDK7rCq01GwYeaDUhBJ3GkfmOZVm4HrgoCmZOGNzxTzDPc0q4IaekySWsbDDTXRXfcObe35nw4zhmwS9GwXuVGINgqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Google Sheets Autosort Example\"\n        title=\"Google Sheets Autosort Example\"\n        src=\"/static/f01d077285902b834c132af8db83b1a7/fcda8/google-sheets-autosort-example.png\"\n        srcset=\"/static/f01d077285902b834c132af8db83b1a7/12f09/google-sheets-autosort-example.png 148w,\n/static/f01d077285902b834c132af8db83b1a7/e4a3f/google-sheets-autosort-example.png 295w,\n/static/f01d077285902b834c132af8db83b1a7/fcda8/google-sheets-autosort-example.png 590w,\n/static/f01d077285902b834c132af8db83b1a7/ef916/google-sheets-autosort-example.png 815w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Google Sheets Autosort","date":"May 22, 2020","description":"Using scripts to automatically sort columns in Google Sheets"}}},"pageContext":{"slug":"/google-sheets-autosort/","previous":{"fields":{"slug":"/palindrome-algorithms/"},"frontmatter":{"title":"Palindrome Algorithms in JavaScript"}},"next":{"fields":{"slug":"/world-wide-waste/"},"frontmatter":{"title":"World Wide Waste"}}}}}